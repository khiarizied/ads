<!-- src/main/resources/templates/layouts/main.html -->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} ?: 'Real Estate App'">Real Estate App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
     <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#10b981',
                        accent: '#8b5cf6',
                        dark: '#1f2937',
                    }
                }
            }
        }
        
       
    
    </script>
     <script src="https://unpkg.com/htmx.org@1.9.6"></script>
</head>
<body class="bg-gray-50">
    <div th:replace="~{fragments/header :: header}"></div>
    <section id="category-section" class="relative h-[500px] bg-cover bg-center flex items-center justify-center" style="background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=1200&amp;q=80');">
        <div class="text-center text-white max-w-3xl px-4">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">Find Your Dream Home</h1>
            <p class="text-xl mb-8 opacity-90">Discover the perfect property that matches your lifestyle and budget. We offer the best real estate opportunities in premium locations.</p>
         

        
        </div>
    </section>
    
     <!-- Search Section -->
    <section class="container mx-auto px-4 -mt-16 relative z-10">
        <div class="bg-white rounded-xl shadow-2xl p-6 md:p-8">
            <div class="flex  justify-center border-b-2 border-gray-100 mb-6">
 
                 <!-- Navigation Categories -->
                 <nav id="categoryMenuA" class="bg-white border-b border-gray-200">
        <div class="container mx-auto px-4">
        
            <div class="flex flex-wrap justify-center gap-6 py-4">
                <a href="#" class="category-link flex flex-col items-center text-indigo-700 font-medium"
                   hx-get="/search/form"
                   hx-target="#searchFormContainer"
                   hx-vals='{"category": "real-estate"}'
                   hx-swap="innerHTML"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-home text-2xl mb-1"></i>
                    <span>Real Estate</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   hx-get="/search/form"
                   hx-target="#searchFormContainer"
                   hx-vals='{"category": "clothing"}'
                   hx-swap="innerHTML"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-tshirt text-2xl mb-1"></i>
                    <span>Clothing</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   hx-get="/search/form"
                   hx-target="#searchFormContainer"
                   hx-vals='{"category": "cars"}'
                   hx-swap="innerHTML"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-car text-2xl mb-1"></i>
                    <span>Cars</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-motorcycle text-2xl mb-1"></i>
                    <span>Motorcycles</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   hx-get="/search/form"
                   hx-target="#searchFormContainer"
                   hx-vals='{"category": "electronics"}'
                   hx-swap="innerHTML"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-laptop text-2xl mb-1"></i>
                    <span>Electronics</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-couch text-2xl mb-1"></i>
                    <span>Furniture</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-dumbbell text-2xl mb-1"></i>
                    <span>Sports</span>
                </a>
                <a href="#" class="category-link flex flex-col items-center text-gray-600 hover:text-indigo-700 transition-colors"
                   onclick="setActiveCategory(this)">
                    <i class="fas fa-paw text-2xl mb-1"></i>
                    <span>Pets</span>
                </a>
                
            </div>

        </div>
    </nav>
                
                
            </div>
            
            <div id="searchFormContainer">
                <form class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
                <div class="flex flex-col">
                    <label class="font-medium text-gray-700 mb-2">Location</label>
                    <select class="px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-secondary outline-none">
                        <option>New York</option>
                        <option>Los Angeles</option>
                        <option>Chicago</option>
                        <option>Miami</option>
                        <option>San Francisco</option>
                    </select>
                </div>
                
                <div class="flex flex-col">
                    <label class="font-medium text-gray-700 mb-2" id="typeLabel">Property Type</label>
                    <select class="px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-secondary outline-none" id="typeSelect">
                        <option>Any Type</option>
                        <option>House</option>
                        <option>Apartment</option>
                        <option>Condo</option>
                        <option>Townhouse</option>
                    </select>
                </div>
                
                <div class="flex flex-col">
                    <label class="font-medium text-gray-700 mb-2" id="priceLabel">Price Range</label>
                    <select class="px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-secondary outline-none" id="priceSelect">
                        <option>Any Price</option>
                        <option>$100,000 - $300,000</option>
                        <option>$300,000 - $500,000</option>
                        <option>$500,000 - $1,000,000</option>
                        <option>$1,000,000+</option>
                    </select>
                </div>
                
                <div class="flex flex-col">
                    <label class="font-medium text-gray-700 mb-2" id="additionalLabel">Bedrooms</label>
                    <select class="px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-secondary outline-none" id="additionalSelect">
                        <option>Any</option>
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4+</option>
                    </select>
                </div>
                
                <div class="flex flex-col justify-end">
                    <button class="px-6 py-3 bg-primary rounded-lg hover:bg-red-700 transition-colors font-bold text-white shadow-lg">
                        Search
                    </button>
                </div>
            </form>
          </div>
        </div>
    </section>
    <div class="container mx-auto px-4 py-8">
    
    
       
    
        
        <!-- Featured Categories -->
    <section  class="container mx-auto px-4 py-16">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-dark mb-4">Popular Categories</h2>
            <p class="text-gray-600 text-lg">Discover the most searched categories on our platform</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            <!-- Real Estate -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                <div class="h-48 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');"></div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-2">Real Estate</h3>
                    <p class="text-gray-600 mb-4">Homes, apartments, and commercial properties</p>
                    <button class="text-primary font-medium hover:text-blue-700 transition-colors">Browse Properties â†’</button>
                </div>
            </div>
            
            <!-- Clothing -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                <div class="h-48 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1489987707025-afc232f7ea0f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');"></div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-2">Clothing & Fashion</h3>
                    <p class="text-gray-600 mb-4">New and used clothes, shoes, and accessories</p>
                    <button class="text-primary font-medium hover:text-blue-700 transition-colors">Browse Fashion â†’</button>
                </div>
            </div>
            
            <!-- Cars -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                <div class="h-48 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1542362567-b07e54358753?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');"></div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-2">Cars & Vehicles</h3>
                    <p class="text-gray-600 mb-4">New and used cars, trucks, and SUVs</p>
                    <button class="text-primary font-medium hover:text-blue-700 transition-colors">Browse Vehicles â†’</button>
                </div>
            </div>
            
            <!-- Electronics -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                <div class="h-48 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1546868871-7041f2a55e12?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');"></div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-2">Electronics</h3>
                    <p class="text-gray-600 mb-4">Phones, laptops, tablets, and gadgets</p>
                    <button class="text-primary font-medium hover:text-blue-700 transition-colors">Browse Electronics â†’</button>
                </div>
            </div>
        </div>
    </section>
            <!-- Recent Ads -->
    <section class="bg-gray-100 py-16">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center mb-12">
                <div>
                    <h2 class="text-3xl font-bold text-dark mb-2">Latest Ads</h2>
                    <p class="text-gray-600">Check out the newest listings on our platform</p>
                </div>
                <button class="px-6 py-2 border-2 border-primary text-primary rounded-full hover:bg-primary hover:text-white transition-colors font-medium">
                    View All Ads
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Ad 1 - Real Estate -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <div class="relative h-56 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');">
                        <div class="absolute top-4 left-4 bg-primary text-white px-3 py-1 rounded-full text-sm font-bold">
                            Real Estate
                        </div>
                        <div class="absolute bottom-4 right-4 bg-white bg-opacity-90 text-dark px-3 py-1 rounded-lg font-bold">
                            $850,000
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Modern Luxury Villa</h3>
                        <p class="text-gray-600 mb-4">Beautiful 4-bedroom villa in downtown area with stunning views</p>
                        <div class="flex justify-between items-center">
                            <div class="text-gray-500 text-sm">
                                <i class="fas fa-map-marker-alt mr-1"></i> New York
                            </div>
                            <button class="text-primary hover:text-blue-700 font-medium">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ad 2 - Clothing -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <div class="relative h-56 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1521334884684-d80222895326?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');">
                        <div class="absolute top-4 left-4 bg-secondary text-white px-3 py-1 rounded-full text-sm font-bold">
                            Clothing
                        </div>
                        <div class="absolute bottom-4 right-4 bg-white bg-opacity-90 text-dark px-3 py-1 rounded-lg font-bold">
                            $120
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Designer Leather Jacket</h3>
                        <p class="text-gray-600 mb-4">Genuine leather jacket, barely used, perfect condition</p>
                        <div class="flex justify-between items-center">
                            <div class="text-gray-500 text-sm">
                                <i class="fas fa-map-marker-alt mr-1"></i> Los Angeles
                            </div>
                            <button class="text-primary hover:text-blue-700 font-medium">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ad 3 - Car -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <div class="relative h-56 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1549399542-7e7f8c3ae249?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');">
                        <div class="absolute top-4 left-4 bg-accent text-white px-3 py-1 rounded-full text-sm font-bold">
                            Cars
                        </div>
                        <div class="absolute bottom-4 right-4 bg-white bg-opacity-90 text-dark px-3 py-1 rounded-lg font-bold">
                            $28,500
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">2020 Toyota Camry</h3>
                        <p class="text-gray-600 mb-4">Low mileage, excellent condition, one owner</p>
                        <div class="flex justify-between items-center">
                            <div class="text-gray-500 text-sm">
                                <i class="fas fa-map-marker-alt mr-1"></i> Chicago
                            </div>
                            <button class="text-primary hover:text-blue-700 font-medium">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ad 4 - Motorcycle -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <div class="relative h-56 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1558981403-c5f9899a28bc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');">
                        <div class="absolute top-4 left-4 bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                            Motorcycles
                        </div>
                        <div class="absolute bottom-4 right-4 bg-white bg-opacity-90 text-dark px-3 py-1 rounded-lg font-bold">
                            $12,000
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">2019 Harley Davidson</h3>
                        <p class="text-gray-600 mb-4">Well maintained, low mileage, custom accessories</p>
                        <div class="flex justify-between items-center">
                            <div class="text-gray-500 text-sm">
                                <i class="fas fa-map-marker-alt mr-1"></i> Miami
                            </div>
                            <button class="text-primary hover:text-blue-700 font-medium">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ad 5 - Electronics -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <div class="relative h-56 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1546868871-7041f2a55e12?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');">
                        <div class="absolute top-4 left-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                            Electronics
                        </div>
                        <div class="absolute bottom-4 right-4 bg-white bg-opacity-90 text-dark px-3 py-1 rounded-lg font-bold">
                            $899
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">iPhone 14 Pro Max</h3>
                        <p class="text-gray-600 mb-4">Like new condition, unlocked, 256GB storage</p>
                        <div class="flex justify-between items-center">
                            <div class="text-gray-500 text-sm">
                                <i class="fas fa-map-marker-alt mr-1"></i> San Francisco
                            </div>
                            <button class="text-primary hover:text-blue-700 font-medium">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ad 6 - Furniture -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <div class="relative h-56 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1555041469-a586c61ea9bc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80');">
                        <div class="absolute top-4 left-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                            Furniture
                        </div>
                        <div class="absolute bottom-4 right-4 bg-white bg-opacity-90 text-dark px-3 py-1 rounded-lg font-bold">
                            $450
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Modern Sofa Set</h3>
                        <p class="text-gray-600 mb-4">3-piece sofa set, cream color, excellent condition</p>
                        <div class="flex justify-between items-center">
                            <div class="text-gray-500 text-sm">
                                <i class="fas fa-map-marker-alt mr-1"></i> Boston
                            </div>
                            <button class="text-primary hover:text-blue-700 font-medium">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
        <section layout:fragment="content">
            <!-- Content will be inserted here -->
        </section>
    </div>
    
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2023 Real Estate App. All rights reserved.</p>
        </div>
    </footer>

    <!-- Include Confirmation Dialog -->
    <div th:replace="~{fragments/confirmation-dialog}"></div>
    <!-- Footer -->
    <footer class="bg-dark text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
                <div>
                    <h3 class="text-2xl font-bold mb-4 text-primary">
                        <i class="fas fa-store mr-2"></i>Market<span class="text-secondary">Place</span>
                    </h3>
                    <p class="text-gray-300 mb-6">Your trusted platform for buying and selling anything. Connect with buyers and sellers in your community.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 bg-gray-700 rounded-full flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-gray-700 rounded-full flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-gray-700 rounded-full flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-gray-700 rounded-full flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-xl font-bold mb-6">Categories</h3>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Real Estate</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Clothing & Fashion</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Cars & Vehicles</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Electronics</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Furniture</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-xl font-bold mb-6">Quick Links</h3>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Home</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Browse Ads</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Post an Ad</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">My Account</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-primary transition-colors">Help Center</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-xl font-bold mb-6">Contact Us</h3>
                    <ul class="space-y-4 text-gray-300">
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt mt-1 mr-3"></i>
                            <span>123 Market Street, New York, NY 10001</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone mr-3"></i>
                            <span>(555) 123-4567</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope mr-3"></i>
                            <span>support@marketplace.com</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-clock mr-3"></i>
                            <span>Mon-Fri: 9AM-6PM</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-700 pt-8 text-center text-gray-400">
                <p>&copy; 2023 MarketPlace. All rights reserved. | Privacy Policy | Terms of Service</p>
            </div>
        </div>
    </footer>
     <script>
        // Array to store the selected File objects
        let selectedFiles = [];

        /**
         * Handles file selection via the file input dialog.
         * Filters for image files, enforces the 10-file limit,
         * and triggers preview generation.
         */
        function handlePhotoUpload(event) {
            const files = Array.from(event.target.files);
            // --- FIX 1: Filter for image files only (like drag/drop does) ---
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            if (imageFiles.length !== files.length) {
                 // Optional: Alert user if non-images were selected
                 console.warn("Some selected files were not images and were ignored.");
                 // alert("Please select only image files (JPG, PNG, GIF).");
            }
            // Limit to 10 photos
            const totalFiles = selectedFiles.length + imageFiles.length;
          
            if (totalFiles > 10) {
                alert(`You can only add ${10 - selectedFiles.length} more photo(s).`);
                // Add only enough files to reach the limit
                const slotsAvailable = 10 - selectedFiles.length;
                selectedFiles.push(...imageFiles.slice(0, slotsAvailable));
            } else {
                selectedFiles.push(...imageFiles); // Use imageFiles instead of files
            }
           
            displayPhotoPreview(); // Update previews
        }

        /**
         * Generates thumbnail previews for the selected files.
         * Creates image elements and delete buttons.
         */
        function displayPhotoPreview() {
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = ''; // Clear existing previews

            if (selectedFiles.length === 0) {
                // If no files, ensure the file input is also cleared and return
                updateFileInput();
                return;
            }

            // Process each selected file
            selectedFiles.forEach((file, index) => {
                const reader = new FileReader();

                reader.onload = function(e) {
                    // Create container div for the preview
                    const photoDiv = document.createElement('div');
                    photoDiv.className = 'photo-preview';

                    // Create the image element
                    const img = document.createElement('img');
                    img.src = e.target.result; // Set image source to data URL
                    img.alt = `Preview ${index + 1}`;

                    // Create the remove button
                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.className = 'remove-btn';
                    // --- FIX 2: Use direct assignment for onclick, passing the index ---
                    removeBtn.onclick = function() {
                        removePhoto(index); // Call remove function with correct index
                    };

                    // --- FIX 3: Create remove icon using text (more robust) ---
                    const icon = document.createElement('span');
                    icon.innerHTML = '&times;'; // HTML entity for multiplication sign (Ã—)
                    // Optional styling for the icon
                    // icon.style.fontSize = '16px';
                    // icon.style.fontWeight = 'bold';

                    // Assemble the elements
                    removeBtn.appendChild(icon);
                    photoDiv.appendChild(img);
                    photoDiv.appendChild(removeBtn);

                    // Add the preview to the container
                    
                    preview.appendChild(photoDiv);
                    
                };

                reader.onerror = function() {
                    console.error(`Error reading file: ${file.name}`);
                };

                // Start reading the file as a Data URL
                reader.readAsDataURL(file);
            });

            // --- FIX 4: Ensure file input is updated AFTER previews are handled ---
            // Update the hidden file input to match the selectedFiles array
            updateFileInput();
        }


        /**
         * Removes a photo from the selectedFiles array and updates previews.
         * @param {number} index - The index of the file to remove in selectedFiles.
         */
        function removePhoto(index) {
            // Remove the file from the array at the specified index
            if (index >= 0 && index < selectedFiles.length) {
                selectedFiles.splice(index, 1);
                // Update the preview display (this recreates elements with correct indices)
                displayPhotoPreview();
                // Update the file input to reflect the changes
                updateFileInput();
            } else {
                console.warn(`Attempted to remove photo at invalid index: ${index}`);
            }
        }

        /**
         * Updates the hidden file input element to match the current selectedFiles array.
         * This is crucial for form submission to include the correct files.
         */
        function updateFileInput() {
            const input = document.getElementById('photoFiles');
            const dt = new DataTransfer(); // Create a new DataTransfer object
            // Add each selected file to the DataTransfer object
            selectedFiles.forEach(file => {
                dt.items.add(file);
            });
            // Assign the files from DataTransfer to the input
            input.files = dt.files;
        }

        // --- Drag and Drop Functionality ---
        const uploadArea = document.getElementById('photoUploadArea');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault(); // Prevent default browser behavior
            uploadArea.style.borderColor = '#6366f1'; // Change border on drag over
            uploadArea.style.backgroundColor = '#f8fafc'; // Change background
        });

        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#d1d5db'; // Revert border
            uploadArea.style.backgroundColor = ''; // Revert background
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault(); // Prevent default browser behavior (opening file)
            uploadArea.style.borderColor = '#d1d5db'; // Revert border
            uploadArea.style.backgroundColor = ''; // Revert background

            // Get files from the drop event and filter for images
            const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
            if (files.length === 0) {
                 alert("Please drop image files only.");
                 return;
            }

            // Limit to 10 photos
            const totalFiles = selectedFiles.length + files.length;
            if (totalFiles > 10) {
                alert(`Adding these files would exceed the 10-photo limit. Please remove some files or add fewer.`);
                // Add only enough files to reach the limit
                const slotsAvailable = 10 - selectedFiles.length;
                selectedFiles.push(...files.slice(0, slotsAvailable));
            } else {
                selectedFiles.push(...files);
            }

            // Update previews and file input
            displayPhotoPreview();
            // Note: updateFileInput is called inside displayPhotoPreview
        });

        // Optional: Click on upload area to trigger file selection
        uploadArea.addEventListener('click', (e) => {
            // Check if the click target is the area itself or specific child elements
            // This prevents clicks on buttons/inputs inside from re-triggering file dialog
            if (e.target === uploadArea || e.target.tagName === 'P' || e.target.tagName === 'I') {
                document.getElementById('photoFiles').click();
            }
        });
        
        
        
        /******************************************************************************************/
        
         let newSelectedFiles = [];

        function previewMultiplePhotos(event) {
            const files = Array.from(event.target.files);
            // Filter for image files only
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            newSelectedFiles = [...newSelectedFiles, ...imageFiles].slice(0, 10); // Limit to 10 new photos
            displayNewPhotoPreview();
        }

        function displayNewPhotoPreview() {
            const preview = document.getElementById('newPhotoPreview');
            preview.innerHTML = '';

            if (newSelectedFiles.length === 0) {
                return;
            }

            // Process each file individually
            newSelectedFiles.forEach((file, index) => {
                const reader = new FileReader();

                reader.onload = function(e) {
                    // Create photo container
                    const photoDiv = document.createElement('div');
                    photoDiv.className = 'photo-preview';

                    // Create image element
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = `New photo preview ${index + 1}`;

                    // Create remove button
                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.className = 'remove-btn';
                    removeBtn.onclick = function() {
                        removeNewPhoto(index);
                    };

                    // Create close icon (using text since FontAwesome might not be available)
                    const icon = document.createElement('span');
                    icon.innerHTML = 'Ã—';
                    icon.style.fontSize = '14px';
                    icon.style.fontWeight = 'bold';

                    // Assemble elements
                    removeBtn.appendChild(icon);
                    photoDiv.appendChild(img);
                    photoDiv.appendChild(removeBtn);
                    preview.appendChild(photoDiv);
                };

                reader.onerror = function() {
                    console.error(`Error reading file: ${file.name}`);
                };

                reader.readAsDataURL(file);
            });

            // Update file input
            updateNewFileInput();
        }

        function removeNewPhoto(index) {
            // Remove the file from the array
            newSelectedFiles.splice(index, 1);

            // Update the preview display
            displayNewPhotoPreview();
        }

        function updateNewFileInput() {
            const input = document.getElementById('photoFiles');
            
            // Create a new DataTransfer object to update the file input
            const dt = new DataTransfer();
            newSelectedFiles.forEach(file => {
                dt.items.add(file);
            });
            
            input.files = dt.files;
        }
       
        
        document.body.addEventListener('htmx:confirm', function (event) {
            const el = event.target;

            // Optional: only apply to elements with a specific class
            if (el.classList.contains('delete-btn')) {
              const confirmed = confirmDeletePhoto(el);

              if (!confirmed) {
                event.preventDefault(); // cancel the request
              }
            }
          });
     /*   function confirmDeletePhoto(button) {
            if (confirm('Are you sure you want to delete this photo? This action cannot be undone.')) {
                button.closest('form').submit();
            }
        }*/

        // Drag and drop functionality
           document.addEventListener('DOMContentLoaded', function() {
        	alert("yyyyyyyyyyyyyyyyyyyy");
            const uploadArea = document.getElementById('photoUploadArea');

            // Prevent default drag behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // Highlight drop area when item is dragged over it
            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                uploadArea.style.borderColor = '#6366f1';
                uploadArea.style.backgroundColor = '#f8fafc';
            }

            function unhighlight(e) {
                uploadArea.style.borderColor = '#d1d5db';
                uploadArea.style.backgroundColor = '';
            }

            // Handle dropped files
            uploadArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = Array.from(dt.files);

                // Filter for image files only
                const imageFiles = files.filter(file => file.type.startsWith('image/'));

                if (imageFiles.length > 0) {
                    newSelectedFiles = [...newSelectedFiles, ...imageFiles].slice(0, 10);
                    
                    // Update the file input to reflect dropped files
                    const input = document.getElementById('photoFiles');
                    const dataTransfer = new DataTransfer();
                    newSelectedFiles.forEach(file => {
                        dataTransfer.items.add(file);
                    });
                    input.files = dataTransfer.files;
                    
                    displayNewPhotoPreview();
                }
            }

            // Click on upload area to trigger file selection
            uploadArea.addEventListener('click', (e) => {
                if (e.target === uploadArea || e.target.tagName === 'P' || e.target.tagName === 'I') {
                    document.getElementById('photoFiles').click();
                }
            });
        });
        
      /***********************************************************************************************/
      
      
      
         function previewPhoto(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('photoPreview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = '<img src="' + e.target.result + '" alt="Preview">';
                }
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '<i class="fas fa-user"></i>';
            }
        }
      
      
   
         
         
    </script>


<script>
// Function to handle category click and set active state
function setActiveCategory(clickedElement) {
    // Remove active styling from all category links
    const categoryLinks = document.querySelectorAll('.category-link');
    categoryLinks.forEach(link => {
        link.classList.remove('text-indigo-700', 'font-medium');
        link.classList.add('text-gray-600');
    });

    // Add active styling to clicked element
    clickedElement.classList.remove('text-gray-600');
    clickedElement.classList.add('text-indigo-700', 'font-medium');
}
</script>

</body>
</html>